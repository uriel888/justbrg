files:
  /etc/nginx/conf.d/https.conf:
    mode: "000644"
    owner: root
    group: root
    content: |
      # HTTPS server

      server {
          listen       443;
          server_name  localhost;

          ssl                  on;
          ssl_certificate      /etc/pki/tls/certs/server.crt;
          ssl_certificate_key  /etc/pki/tls/certs/server.key;

          ssl_session_timeout  5m;

          ssl_protocols  TLSv1 TLSv1.1 TLSv1.2;
          ssl_ciphers "EECDH+AESGCM:EDH+AESGCM:AES256+EECDH:AES256+EDH";
          ssl_prefer_server_ciphers   on;

          location / {
              proxy_pass  http://nodejs;
              proxy_set_header   Connection "";
              proxy_http_version 1.1;
              proxy_set_header        Host            $host;
              proxy_set_header        X-Real-IP       $remote_addr;
              proxy_set_header        X-Forwarded-For $proxy_add_x_forwarded_for;
          }
      }
  /etc/pki/tls/certs/server.crt:
    mode: "000400"
    owner: root
    group: root
    content: |
      -----BEGIN CERTIFICATE-----
      MIIEDTCCAvWgAwIBAgIJAKaDdovrJoLZMA0GCSqGSIb3DQEBCwUAMIGcMQswCQYD
      VQQGEwJVUzEQMA4GA1UECAwHaW5kaWFuYTEXMBUGA1UEBwwOd2VzdCBsYWZheWV0
      dGUxEDAOBgNVBAoMB2p1c3RicmcxEDAOBgNVBAsMB2p1c3RicmcxGDAWBgNVBAMM
      D3podW9zaGVuZyBqaWFuZzEkMCIGCSqGSIb3DQEJARYVamVtaXQudXJpZWxAZ21h
      aWwuY29tMB4XDTE2MDgxNTA1MzEwOFoXDTE3MDgxNTA1MzEwOFowgZwxCzAJBgNV
      BAYTAlVTMRAwDgYDVQQIDAdpbmRpYW5hMRcwFQYDVQQHDA53ZXN0IGxhZmF5ZXR0
      ZTEQMA4GA1UECgwHanVzdGJyZzEQMA4GA1UECwwHanVzdGJyZzEYMBYGA1UEAwwP
      emh1b3NoZW5nIGppYW5nMSQwIgYJKoZIhvcNAQkBFhVqZW1pdC51cmllbEBnbWFp
      bC5jb20wggEiMA0GCSqGSIb3DQEBAQUAA4IBDwAwggEKAoIBAQD3UtB9sFNWOnHc
      1DH15r7yd7m+n1L2MzUvAhRMOXklhPhEBcB17TMw5SCKvCvaI4eHhKavS3UMZnT3
      HlTpVtiu8u/5w3jxa6zCk2zEDAAEdbf11EsASqwhvgP4pPg8JDRVUmW3qWS1Jn5W
      oVniixAV2c+VoFc4tvKCwfH8woAOSa7jMuSqjXaLtbABRv6wpYcRHBe6n/gugLBc
      78SUO5QC0IxggReqLidjdOwlzPhIQFcPxQUkromkiQOEmFWNPmFMUiC83Sv1Ufph
      luKYSijyurnp2MDS+45S3ZtXLPY24uJ3rHxkvjKPcB8l/852HeR/hqnDMyQVSdGi
      h0Gt/nPxAgMBAAGjUDBOMB0GA1UdDgQWBBRCza3yfXWeqqN7qa/yFrS2lf/HJjAf
      BgNVHSMEGDAWgBRCza3yfXWeqqN7qa/yFrS2lf/HJjAMBgNVHRMEBTADAQH/MA0G
      CSqGSIb3DQEBCwUAA4IBAQDI6eAxjoMNbLlSy0v/cPHHBOtI1ZfaDYx1MR1Bi/0N
      w2t7pFQ43GTfGE8hRr3BgPRVT7xwcB+t0KdydZIzvGlEnN2DLH9WkD5Ty3W60tfu
      74L9nQ3kGuybzHfRtt8/ezyRKb+osOyzmlgn5rE+29w72SYE3L8DOTR9OrbzAj5N
      K3Onyi8+5WDdhDgnC8qSzPLO6G3U7WledVW2jV2nPq1/b+qP8k3wJtn7YoDV5TWP
      IzreYCh8SkWWtJW4hN2NnX+wpGgjMzPyi+CNdsTY1v0WF4+Vcdez1L+7h//1vxUQ
      wMvtzp7eIy8VgY9i4xcn+lcsLQ2QNYjHl8wnGETohEaV
      -----END CERTIFICATE-----

  /etc/pki/tls/certs/server.key:
    mode: "000400"
    owner: root
    group: root
    content: |
        -----BEGIN PRIVATE KEY-----
        MIIEvAIBADANBgkqhkiG9w0BAQEFAASCBKYwggSiAgEAAoIBAQD3UtB9sFNWOnHc
        1DH15r7yd7m+n1L2MzUvAhRMOXklhPhEBcB17TMw5SCKvCvaI4eHhKavS3UMZnT3
        HlTpVtiu8u/5w3jxa6zCk2zEDAAEdbf11EsASqwhvgP4pPg8JDRVUmW3qWS1Jn5W
        oVniixAV2c+VoFc4tvKCwfH8woAOSa7jMuSqjXaLtbABRv6wpYcRHBe6n/gugLBc
        78SUO5QC0IxggReqLidjdOwlzPhIQFcPxQUkromkiQOEmFWNPmFMUiC83Sv1Ufph
        luKYSijyurnp2MDS+45S3ZtXLPY24uJ3rHxkvjKPcB8l/852HeR/hqnDMyQVSdGi
        h0Gt/nPxAgMBAAECggEALKujhqAbXT6vJCCbaXukz2x6ewiR1nAHUhdBDUdwLyum
        H7seOO5/yXwI9aXpEbxLFVoLNSwe1v+Gbr/mvEJ4Xpj4aRc6N/inunkgMwSr2CJe
        +KLAbSwPjQSh+P3q7Anp/eMlBhgtXV63gPQhpP5TCG9PxAmy10aL5Lwc9fc3Y9zm
        Nxb95UQIU/F/PzbhhyjJDsmr2DI9qBpCZyT148eJfXmO9r8XUve2iMSBzwTn9/zx
        N+3GEeM9doOX9V/oVzpUiS+56kNKO8EfJQfvhkiLtxMB8Fk0IcbdQzBANos11Ray
        nUdDVpmcu/ixmtTwnaAYTKeQ+qCNGbJ4gvxOCyETJQKBgQD/EhXptMd9qjoEqwC+
        ufrUIChDAEHdEJWYIVr/UD60TmSHuuE1GfXSZ0CUj61igDJoyXGQ3O8LFCLyjtpo
        AakmshN65jbw01qd3KzHok2JPTHpzXCB6PpFlz2pfpc/mePMmW8KCkx6ZtLpAU46
        URcKvQtNlp7HBNjOtW/AogXSwwKBgQD4OYC0BIDArCeJJpsDFRbfgJV62T/PPdd9
        VKkkfs3k2g1TQUCCClNrfRRX2y9UcsJRZP5O8AWUiuHvohzghdZU49B/sEG9oTDZ
        MjXwhhYv57ynHrJUbvfwuyjV6IPMRvPNcIG7U3s6YmoB96d9o+XIzzkfyX6MNLgo
        +t9LbH2LOwKBgGIkE0pYxGkVlj01jpPT+y6jMNqWvsDQIL7oFpslxPqbLxMKVJyZ
        4HuUPsTqg0vjB4JJ/+g9GbypgsjRLjfWa773xYcEDR+cMsGKpvApAqxLX2kWIrPZ
        cHJWPuN4Ubmm/H88ifzS+Zoe9gew+Oh3SuZW1oKD8ZOhycm/BcCYlqUBAoGAJ6jQ
        VnLNu3sGChS/+ZsZ/3XE7E7fshX4Yw7uw2T7MpBgRqgLTXum3mqqoGrlwgFf6K9R
        Ln2M9rHF7YqiQIFBwGhxvKUFq+2gJ2OtWJOj4d2Nt8ngxjrApJbSrHKs9Ct18qIC
        KFLrQmXM+CmAekOAiDgLsXd5H5+guPN0T9GysVcCgYBmYGmgGs4nABlfkZG5sxXy
        f0d7ZRwxMtEvGfnwb0gvrmqJXNfzLNqn2Sr5wfzQwg4hniNFiSSEIIzVAHcylenO
        7vrMMTQM3V2XdImJlDHftKg5gLFpfEPX7EbzkmCCVf8xuDuL/HtxQVtjsvbsrcvZ
        IfxIO2wDiBWsx5ui72K/Lw==
        -----END PRIVATE KEY-----
